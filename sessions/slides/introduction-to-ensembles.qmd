---
title: "Multi-model ensembles"
author: "Understanding, evaluating, and improving forecasts of infectious disease burden"
format:
  revealjs:
    output: slides/forecasting-as-an-epidemiological-problem.html
    footer: "Multi-model ensembles"
slide-level: 3
---

## Different types of models {.smaller}

![](figures/mechanism.png){width="70%"}

:::: {.columns}

::: {.column}

- We can classify models by the level of mechanism they include
- All of the model types we will introduce in the next few slides have been used for COVID-19 forecasting (the US and/or European COVID-19 forecast hub)

**NOTE:**  level of mechanism $\neq$ model complexity

:::

::: {.column}

![](https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fs41597-022-01517-w/MediaObjects/41597_2022_1517_Fig4_HTML.png?as=webp)

[Cramer *et al.*, *Scientific Data*, 2022](https://doi.org/10.1038/s41597-022-01517-w)

:::

::::

### {.smaller}

![](figures/mechanism1.png){width="70%"}

:::: {.columns}

::: {.column}

**Complex agent-based models**

Conceptually probably the closest to metereological forecasting, if with much less real-time data.

:::

::: {.column}

![](https://ars.els-cdn.com/content/image/1-s2.0-S1755436517300221-gr1.jpg)

[Venkatramanan *et al.*, *Epidemics*, 2018](https://doi.org/10.1016/j.epidem.2017.02.010)

:::

::::

### {.smaller}

![](figures/mechanism2.png){width="70%"}

:::: {.columns}

::: {.column}

**Compartmental models**

Aim to capture relevant mechanisms but without going to the individual level.

:::

::: {.column}

![](https://journals.plos.org/ploscompbiol/article/figure/image?size=large&id=10.1371/journal.pcbi.1008619.g001)

[Keeling *et al.*, *PLOS Comp Biol*, 2021](https://doi.org/10.1371/journal.pcbi.1008619)

:::

::::

### {.smaller}

![](figures/mechanism3.png){width="70%"}

:::: {.columns}

::: {.column}

**Semi-mechanistic models**

- Include some epidemiological mechanism (e.g. SIR or the renewal equation)
- Add a nonmechanistic time component inspired by statistical models (e.g. random walk)
- e.g., the model we have worked with so far

:::

::: {.column}

![](https://ars.els-cdn.com/content/image/1-s2.0-S1755436516300445-gr2.jpg)

[Funk *et al.*, *Epidemics*, 2018](http://dx.doi.org/10.1016/j.epidem.2016.11.003)

:::

::::

### {.smaller}

![](figures/mechanism4.png){width="70%"}

:::: {.columns}

::: {.column}

**Statistical models**

- Models that don't include any epidemiological background e.g. ARIMA; also called *time-series models*
- The random walk model when used on its own (without going via $R_t$) is called a [stochastic volatility model](https://mc-stan.org/docs/stan-users-guide/time-series.html#stochastic-volatility-models)

:::

::: {.column}

![](figures/muni_model.png)

:::

::::

### {.smaller}

![](figures/mechanism.png){width="70%"}

:::: {.columns}

::: {.column}

**Other models**

- Expert or crowd opinion
- Machine learning
- ...

:::

::: {.column}

![](figures/crowdforecastr.png)

[Bosse *et al.*, *Wellcome Open Res*, 2024](https://doi.org/10.12688/wellcomeopenres.19380.2)

:::

::::


## Ensembles

- Combine many different models' forecasts into a single prediction

## Why ensemble?

::: {.fragment .fade-in}
Many uncertainties, many approaches: many models

   - Layers of uncertainty
  
      - Model parameters
        - e.g. parameterising delay distributions
        
      - Model structure
        - e.g. more mechanistic or more statistical approaches
   - Want to use all available information
:::

## Why ensemble?

"Whole is greater than sum of parts"

   - Average of multiple predictions is often more performant than any individual model
   
      - History in weather & economic forecasting
      
      - Seen this in infectious disease forecasting

        - "Forecast challenges": Ebola, dengue, flu, COVID-19...

## Ensemble methods

::: {.fragment .fade-in}

- Summarising across models to create single (probabilistic) prediction

  - e.g. average at each models' probabilistic quantiles

     - Mean

     - Median - trims the outliers, so narrows the uncertainty
:::

## Ensemble methods

- Equal or weighted combination

   - Weight models by past forecast performance
   
      - e.g. using forecast scores
      
   - Rarely better than equal average

## Collaborative modelling

### "Forecast hubs"

- Crowdsourcing forecasts

   - Open source collaborative projects 

   - Anyone able to contribute a forecast
   
- Forecasts ensembled into a single projection
   
- Also enables consistent evaluation

- Outbreak modelling

  - Since 2013 for US influenza

   - Ebola, dengue, chikungunya, COVID-19, WNV

##

... European [Respicast](https://respicast.ecdc.europa.eu/)

![](figures/respicast-forecasts.png)

## Single model {.smaller}
![](figures/respicast-single.png)

## ... Multiple models {.smaller}
![](figures/respicast-multi.png)

## ... ... Multi-model ensemble {.smaller}
![](figures/respicast-comparison.png)

## `r fontawesome::fa("laptop-code", "white")` Your Turn {background-color="#447099" transition="fade-in"}

1. Create unweighted and weighted ensembles using forecasts from multiple models.
2. Evaluate the forecasts from ensembles compared to their constituent models.

#

[Return to the session](../forecast-ensembles)


